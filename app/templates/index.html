{% extends "base.html" %}

{% block content %}

<br><br>
<div class = "page-content">
  <h1>Products</h1>
  <div class="flash-notifications">
    {% with messages = get_flashed_messages() %}
    {% if messages %}
    <div>
      {% for message in messages %}
      <div class="flash-message">⚠️ {{ message }}</div>
      {% endfor %}
    </div>
    {% endif %}
    {% endwith %}
  </div>

  <h2>Products for sale:</h2>
  <div class="grid">
    {% for tuple in avail_products%}
      <div class="grid-item">
        <div class="item-image">Image: {{tuple.image}}</div>
        <div>Product ID: {{tuple.id}}</div>
        <h3>{{tuple.name}}</h3>
        <div class="item-description"><span class="item-category">{{tuple.category}}</span>{{tuple.description}}</div>
        
        <div class="item-price">${{tuple.unit_price}}</div>
      </div>
    {% endfor %}
  </div>



  <br><br>
  {% if current_user.is_authenticated %}
  <h2>Your recent purchases:</h2>
  <div class="grid">
    {% for tuple in purchase_history%}
      <div class="grid-item">
        <div class="item-image">Image: {{tuple.image}}</div>
        <div>Product ID: {{tuple.id}}</div>
        <h3>{{tuple.name}}</h3>
        <div class="item-description"><span class="item-category">{{tuple.category}}</span>{{tuple.description}}</div>
        
        <div class="item-price">${{tuple.unit_price}}</div>
      </div>
    {% endfor %}

  </div>
</div>
{% else %}
<p><a href="{{ url_for('users.login') }}">Log in</a> to see your purchase history!</p>
{% endif %}

{% endblock %}
